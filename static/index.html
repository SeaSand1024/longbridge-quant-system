<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>美股量化交易系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* 移动端优化 */
        * {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* 隐藏滚动条但保持滚动功能 */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* 移动端表格横向滚动优化 */
        .mobile-table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x mandatory;
        }
        
        /* 移动端卡片触摸反馈 */
        .mobile-touch {
            transition: transform 0.15s ease, opacity 0.15s ease;
        }
        .mobile-touch:active {
            transform: scale(0.97);
            opacity: 0.9;
        }
        
        /* 移动端弹窗优化 */
        @media (max-width: 640px) {
            .mobile-modal {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                max-width: 100%;
                border-radius: 20px 20px 0 0;
                max-height: 90vh;
                animation: slideUp 0.3s ease;
            }
            @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
            }
        }
        
        /* 标签页滚动条美化 */
        .tabs-scroll::-webkit-scrollbar {
            height: 3px;
        }
        .tabs-scroll::-webkit-scrollbar-track {
            background: rgba(55, 65, 81, 0.5);
        }
        .tabs-scroll::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 3px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 min-h-screen text-white overflow-x-hidden">
    <!-- 登录页面 -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center px-4">
        <div class="bg-gray-800 rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-md mobile-touch">
            <div class="text-center mb-6 sm:mb-8">
                <i class="fas fa-chart-line text-blue-400 text-4xl sm:text-5xl mb-3 sm:mb-4"></i>
                <h1 class="text-xl sm:text-2xl font-bold">美股量化交易系统</h1>
                <p class="text-gray-400 mt-1 sm:mt-2 text-sm">登录以继续</p>
            </div>
            <form id="loginForm" class="space-y-4 sm:space-y-6">
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">用户名</label>
                    <input type="text" id="loginUsername" required autocapitalize="none"
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请输入用户名">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">密码</label>
                    <input type="password" id="loginPassword" required
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请输入密码">
                </div>
                <div id="loginError" class="hidden text-red-400 text-xs sm:text-sm text-center"></div>
                <button type="submit" class="w-full px-6 py-3.5 sm:py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 font-medium text-base mobile-touch">
                    <i class="fas fa-sign-in-alt mr-2"></i>登录
                </button>
            </form>
            <div class="mt-4 sm:mt-6 text-center text-xs sm:text-sm text-gray-400">
                还没有账号？<a href="#" id="showRegisterBtn" class="text-blue-400 hover:text-blue-300">立即注册</a>
            </div>
        </div>
    </div>

    <!-- 注册页面 -->
    <div id="registerPage" class="hidden min-h-screen flex items-center justify-center px-4">
        <div class="bg-gray-800 rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-md mobile-touch">
            <div class="text-center mb-6 sm:mb-8">
                <i class="fas fa-user-plus text-green-400 text-4xl sm:text-5xl mb-3 sm:mb-4"></i>
                <h1 class="text-xl sm:text-2xl font-bold">注册账号</h1>
                <p class="text-gray-400 mt-1 sm:mt-2 text-sm">创建新账号</p>
            </div>
            <form id="registerForm" class="space-y-4 sm:space-y-6">
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">用户名</label>
                    <input type="text" id="registerUsername" required autocapitalize="none"
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请输入用户名">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">邮箱</label>
                    <input type="email" id="registerEmail" required autocapitalize="none"
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请输入邮箱">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">密码</label>
                    <input type="password" id="registerPassword" required minlength="6"
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请输入密码（至少6位）">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">确认密码</label>
                    <input type="password" id="registerConfirmPassword" required minlength="6"
                           class="w-full px-4 py-3 sm:py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base"
                           placeholder="请再次输入密码">
                </div>
                <div id="registerError" class="hidden text-red-400 text-xs sm:text-sm text-center"></div>
                <button type="submit" class="w-full px-6 py-3.5 sm:py-3 bg-green-600 hover:bg-green-700 rounded-lg transition-colors duration-200 font-medium text-base mobile-touch">
                    <i class="fas fa-user-plus mr-2"></i>注册
                </button>
            </form>
            <div class="mt-4 sm:mt-6 text-center text-xs sm:text-sm text-gray-400">
                已有账号？<a href="#" id="showLoginBtn" class="text-blue-400 hover:text-blue-300">立即登录</a>
            </div>
        </div>
    </div>

    <!-- 主应用页面 -->
    <div id="mainApp" class="hidden">
    <!-- 顶部导航栏 -->
    <nav class="bg-gray-800 bg-opacity-90 backdrop-blur-sm shadow-lg border-b border-blue-500">
        <div class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-14 sm:h-16">
                <div class="flex items-center">
                    <i class="fas fa-chart-line text-blue-400 text-xl sm:text-2xl mr-2 sm:mr-3"></i>
                    <h1 class="text-base sm:text-xl font-bold text-white">美股量化交易系统</h1>
                </div>
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <div id="monitoringStatus" class="hidden sm:flex items-center space-x-2">
                        <span class="w-3 h-3 rounded-full bg-gray-500" id="statusIndicator"></span>
                        <span class="text-sm" id="statusText">未启动</span>
                    </div>
                    <div id="userSection" class="hidden items-center space-x-2">
                        <span class="text-xs sm:text-sm" id="usernameDisplay"></span>
                        <button id="logoutBtn" class="px-2 sm:px-3 py-1 sm:py-1.5 bg-red-600 hover:bg-red-700 rounded-lg transition-colors duration-200 text-xs sm:text-sm font-medium">
                            <i class="fas fa-sign-out-alt mr-1"></i>登出
                        </button>
                    </div>
                    <button id="toggleTestMode" class="px-3 py-1.5 sm:px-4 sm:py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg transition-colors duration-200 text-xs sm:text-sm font-medium">
                        <i class="fas fa-flask mr-1 sm:mr-2"></i><span class="hidden sm:inline">测试模式</span><span class="sm:hidden">测试</span>
                    </button>
                    <button id="toggleMonitoring" class="px-3 py-1.5 sm:px-4 sm:py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-xs sm:text-sm font-medium">
                        <i class="fas fa-play mr-1 sm:mr-2"></i><span class="hidden sm:inline">启动监控</span><span class="sm:hidden">启动</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主内容区 -->
    <div class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8">
        <!-- 统计卡片 -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-4 sm:mb-8">
            <div id="totalAssetsCard" class="bg-gradient-to-br from-indigo-600 to-purple-800 rounded-xl shadow-lg p-4 sm:p-6 transform hover:scale-105 transition-transform duration-200 cursor-pointer">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-indigo-200 text-xs sm:text-sm mb-1">总资产</p>
                        <p class="text-2xl sm:text-3xl font-bold" id="totalAssetsCount">$0.00</p>
                    </div>
                    <i class="fas fa-chart-pie text-3xl sm:text-4xl text-indigo-300 opacity-50"></i>
                </div>
                <p class="text-indigo-200 text-xs mt-2 opacity-75">点击查看详情 →</p>
            </div>

            <div id="activeStocksCard" class="bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl shadow-lg p-4 sm:p-6 transform hover:scale-105 transition-transform duration-200 cursor-pointer">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-blue-200 text-xs sm:text-sm mb-1">活跃股票</p>
                        <p class="text-2xl sm:text-3xl font-bold" id="activeStocksCount">0</p>
                    </div>
                    <i class="fas fa-chart-bar text-3xl sm:text-4xl text-blue-300 opacity-50"></i>
                </div>
                <p class="text-blue-200 text-xs mt-2 opacity-75">点击查看详情 →</p>
            </div>

            <div id="todayTradesCard" class="bg-gradient-to-br from-green-600 to-green-800 rounded-xl shadow-lg p-4 sm:p-6 transform hover:scale-105 transition-transform duration-200 cursor-pointer">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-green-200 text-xs sm:text-sm mb-1">今日交易</p>
                        <p class="text-2xl sm:text-3xl font-bold" id="todayTradesCount">0</p>
                    </div>
                    <i class="fas fa-exchange-alt text-3xl sm:text-4xl text-green-300 opacity-50"></i>
                </div>
                <p class="text-green-200 text-xs mt-2 opacity-75">点击查看详情 →</p>
            </div>

            <div class="bg-gradient-to-br from-orange-600 to-orange-800 rounded-xl shadow-lg p-4 sm:p-6 transform hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex-1">
                        <p class="text-orange-200 text-xs sm:text-sm mb-1">止盈目标</p>
                        <div class="flex items-center space-x-2">
                            <input type="number" id="profitTargetQuickInput" step="0.1" min="0.1" max="100"
                                   class="w-20 sm:w-24 px-2 py-1 text-xl sm:text-3xl font-bold bg-transparent border-b-2 border-orange-400 focus:outline-none focus:border-orange-200 transition-colors duration-200"
                                   value="1.0">
                            <span class="text-xl sm:text-3xl font-bold">%</span>
                        </div>
                    </div>
                    <i class="fas fa-bullseye text-3xl sm:text-4xl text-orange-300 opacity-50"></i>
                </div>
                <p class="text-orange-200 text-xs mt-1">达到此涨幅自动卖出</p>
            </div>
        </div>

        <!-- 标签页 -->
        <div class="bg-gray-800 bg-opacity-90 backdrop-blur-sm rounded-xl shadow-lg overflow-hidden">
            <!-- 标签头 -->
            <div class="flex overflow-x-auto scrollbar-hide tabs-scroll border-b border-gray-700 -mx-3 sm:mx-0 px-3 sm:px-0">
                <button class="tab-button active px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="stocks">
                    <i class="fas fa-list mr-1 sm:mr-2"></i>股票列表
                </button>
                <button class="tab-button px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="market">
                    <i class="fas fa-chart-line mr-1 sm:mr-2"></i>实时行情
                </button>
                <button class="tab-button px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="portfolio">
                    <i class="fas fa-wallet mr-1 sm:mr-2"></i>账户总览
                </button>
                <button class="tab-button px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="trades">
                    <i class="fas fa-history mr-1 sm:mr-2"></i>交易记录
                </button>
                <button class="tab-button px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="orders">
                    <i class="fas fa-file-contract mr-1 sm:mr-2"></i>历史订单
                </button>
                <button class="tab-button px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors duration-200 whitespace-nowrap" data-tab="settings">
                    <i class="fas fa-cog mr-1 sm:mr-2"></i>系统设置
                </button>
            </div>

            <!-- 标签内容 -->
            <div class="p-3 sm:p-6">
                <!-- 股票列表 -->
                <div id="stocksTab" class="tab-content">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-bold">股票列表</h2>
                        <div class="flex flex-wrap gap-2 w-full sm:w-auto">
                            <button id="addStockBtn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                                <i class="fas fa-plus mr-2"></i>添加股票
                            </button>
                            <button id="syncWatchlistBtnInStocks" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                                <i class="fas fa-sync-alt mr-2"></i>同步长桥自选股
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto mobile-table-container -mx-3 sm:mx-0">
                        <div class="inline-block min-w-full align-middle">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">股票代码</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">公司名称</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">类型</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="stocksTableBody">
                                    <!-- 动态加载 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 实时行情 -->
                <div id="marketTab" class="tab-content hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-bold">实时市场行情</h2>
                        <button id="refreshMarketBtn" class="flex-1 sm:flex-none px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                            <i class="fas fa-sync-alt mr-2"></i>刷新
                        </button>
                    </div>

                    <!-- 加速度排行榜 -->
                    <div class="bg-gradient-to-r from-orange-600 to-red-600 rounded-xl shadow-lg p-4 sm:p-6 mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-base sm:text-lg font-bold text-white">
                                <i class="fas fa-rocket mr-2"></i>加速度 Top 10
                            </h3>
                            <select id="accelerationTopN" class="bg-white/20 text-white border border-white/30 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-white/50">
                                <option value="5" class="text-gray-800">Top 5</option>
                                <option value="10" selected class="text-gray-800">Top 10</option>
                                <option value="20" class="text-gray-800">Top 20</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 sm:grid-cols-5 gap-3" id="accelerationTopContainer">
                            <!-- 动态加载 -->
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4" id="marketDataContainer">
                        <!-- 动态加载 -->
                    </div>
                    <div class="mt-6 sm:mt-8">
                        <h3 class="text-base sm:text-lg font-bold mb-3 sm:mb-4">涨幅加速度趋势</h3>
                        <div id="accelerationChart" class="w-full h-64 sm:h-80 bg-gray-900 rounded-lg"></div>
                    </div>
                </div>

                <!-- 账户总览 -->
                <div id="portfolioTab" class="tab-content hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-bold">账户总览</h2>
                        <button id="refreshPortfolioBtn" class="w-full sm:w-auto px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                            <i class="fas fa-sync-alt mr-2"></i>刷新
                        </button>
                    </div>

                    <!-- 总资产卡片 -->
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-lg p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-indigo-200 text-sm mb-1">总资产</p>
                                <p class="text-4xl sm:text-5xl font-bold" id="totalAssets">$0.00</p>
                                <p class="text-indigo-200 text-sm mt-2" id="totalAssetChange">--</p>
                            </div>
                            <i class="fas fa-chart-pie text-5xl sm:text-6xl text-indigo-300 opacity-30"></i>
                        </div>
                        <!-- 多币种显示 -->
                        <div class="grid grid-cols-3 gap-2 mt-4 pt-4 border-t border-indigo-500/30">
                            <div class="text-center">
                                <p class="text-indigo-300 text-xs mb-1">美元 (USD)</p>
                                <p class="text-lg font-semibold" id="totalAssetsUSD">$0.00</p>
                            </div>
                            <div class="text-center">
                                <p class="text-indigo-300 text-xs mb-1">人民币 (CNY)</p>
                                <p class="text-lg font-semibold" id="totalAssetsCNY">¥0.00</p>
                            </div>
                            <div class="text-center">
                                <p class="text-indigo-300 text-xs mb-1">港币 (HKD)</p>
                                <p class="text-lg font-semibold" id="totalAssetsHKD">HK$0.00</p>
                            </div>
                        </div>
                    </div>

                    <!-- 详细数据网格 -->
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 mb-6">
                        <!-- 现金 -->
                        <div class="bg-gray-900 rounded-lg p-4 hover:bg-gray-800 transition-colors duration-200">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-gray-400 text-xs">现金</p>
                                <i class="fas fa-money-bill-wave text-green-400"></i>
                            </div>
                            <p class="text-xl sm:text-2xl font-bold text-white" id="availableCash">$0.00</p>
                        </div>

                        <!-- 持仓总市值 -->
                        <div class="bg-gray-900 rounded-lg p-4 hover:bg-gray-800 transition-colors duration-200">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-gray-400 text-xs">持仓市值</p>
                                <i class="fas fa-chart-bar text-blue-400"></i>
                            </div>
                            <p class="text-xl sm:text-2xl font-bold text-white" id="positionMarketValue">$0.00</p>
                        </div>

                        <!-- 持仓总盈亏 -->
                        <div class="bg-gray-900 rounded-lg p-4 hover:bg-gray-800 transition-colors duration-200">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-gray-400 text-xs">持仓盈亏</p>
                                <i class="fas fa-balance-scale" id="positionPLOffset"></i>
                            </div>
                            <p class="text-xl sm:text-2xl font-bold" id="positionProfitLoss">$0.00</p>
                            <p class="text-xs mt-1" id="positionProfitLossPct">--%</p>
                        </div>

                        <!-- 当日盈亏 -->
                        <div class="bg-gray-900 rounded-lg p-4 hover:bg-gray-800 transition-colors duration-200 col-span-2 sm:col-span-1 lg:col-span-2">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-gray-400 text-xs">当日盈亏</p>
                                <i class="fas fa-calendar-day" id="dailyPLOffset"></i>
                            </div>
                            <p class="text-xl sm:text-2xl font-bold" id="dailyProfitLoss">$0.00</p>
                            <p class="text-xs mt-1" id="dailyProfitLossPct">--%</p>
                        </div>
                    </div>

                    <!-- 持仓明细 -->
                    <div class="bg-gray-900 rounded-lg p-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-briefcase mr-2 text-purple-400"></i>持仓明细
                        </h3>
                        <div class="overflow-x-auto mobile-table-container">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">股票</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">数量</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">持仓成本</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">当前价格</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">市值</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">盈亏</th>
                                        <th class="text-right py-3 px-4 text-xs sm:text-sm font-medium text-gray-400">盈亏比例</th>
                                    </tr>
                                </thead>
                                <tbody id="positionsTableBody">
                                    <!-- 动态加载 -->
                                </tbody>
                            </table>
                        </div>
                        <div id="noPositions" class="text-center py-8 text-gray-400 hidden">
                            <i class="fas fa-inbox text-4xl mb-3"></i>
                            <p>暂无持仓</p>
                        </div>
                    </div>

                    <!-- 今日交易汇总 -->
                    <div class="bg-gray-900 rounded-lg p-6 mt-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-exchange-alt mr-2 text-green-400"></i>今日交易汇总
                        </h3>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4" id="todayTradesSummary">
                            <div class="bg-gray-800 rounded-lg p-4">
                                <p class="text-gray-400 text-xs mb-1">交易次数</p>
                                <p class="text-2xl font-bold text-white" id="todayTradeCount">0</p>
                            </div>
                            <div class="bg-gray-800 rounded-lg p-4">
                                <p class="text-gray-400 text-xs mb-1">买入次数</p>
                                <p class="text-2xl font-bold text-green-400" id="todayBuyCount">0</p>
                            </div>
                            <div class="bg-gray-800 rounded-lg p-4">
                                <p class="text-gray-400 text-xs mb-1">卖出次数</p>
                                <p class="text-2xl font-bold text-red-400" id="todaySellCount">0</p>
                            </div>
                            <div class="bg-gray-800 rounded-lg p-4">
                                <p class="text-gray-400 text-xs mb-1">交易总额</p>
                                <p class="text-2xl font-bold text-blue-400" id="todayTradeVolume">$0.00</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 交易记录 -->
                <div id="tradesTab" class="tab-content hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-bold">交易历史记录</h2>
                        <button id="refreshTradesBtn" class="w-full sm:w-auto px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                            <i class="fas fa-sync-alt mr-2"></i>刷新
                        </button>
                    </div>
                    <div class="overflow-x-auto mobile-table-container -mx-3 sm:mx-0">
                        <div class="inline-block min-w-full align-middle">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400 whitespace-nowrap">时间</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">股票</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">操作</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">价格</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">数量</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">金额</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400 whitespace-nowrap">加速度</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">状态</th>
                                    </tr>
                                </thead>
                                <tbody id="tradesTableBody">
                                    <!-- 动态加载 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 历史订单 -->
                <div id="ordersTab" class="tab-content hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 space-y-3 sm:space-y-0">
                        <h2 class="text-lg sm:text-xl font-bold">历史订单</h2>
                        <div class="flex flex-wrap gap-2 w-full sm:w-auto">
                            <div class="flex items-center space-x-2 flex-1 sm:flex-none">
                                <input type="text" id="orderSymbolFilter" placeholder="输入股票代码筛选"
                                       class="px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-sm w-full sm:w-32">
                                <select id="orderDaysFilter" class="px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-sm">
                                    <option value="7">最近7天</option>
                                    <option value="30">最近30天</option>
                                    <option value="90" selected>最近90天</option>
                                    <option value="180">最近180天</option>
                                    <option value="365">最近1年</option>
                                </select>
                                <button id="filterOrdersBtn" class="px-3 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors duration-200 text-sm font-medium whitespace-nowrap">
                                    <i class="fas fa-filter mr-1"></i>筛选
                                </button>
                            </div>
                            <button id="refreshOrdersBtn" class="flex-1 sm:flex-none px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 text-sm font-medium">
                                <i class="fas fa-sync-alt mr-2"></i>刷新
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto mobile-table-container -mx-3 sm:mx-0">
                        <div class="inline-block min-w-full align-middle">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400 whitespace-nowrap">订单ID</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">股票</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">方向</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">委托价格</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">成交价格</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">委托数量</th>
                                        <th class="text-right py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">成交数量</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400">状态</th>
                                        <th class="text-left py-3 px-2 sm:px-4 text-xs sm:text-sm font-medium text-gray-400 whitespace-nowrap">更新时间</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    <!-- 动态加载 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="noOrders" class="text-center py-8 text-gray-400 hidden">
                        <i class="fas fa-inbox text-4xl mb-3"></i>
                        <p>暂无历史订单数据</p>
                        <p class="text-xs mt-2">请确保已配置长桥SDK并连接到真实交易环境</p>
                        <p class="text-xs mt-2">可能原因：账户无历史订单、查询时间范围内无订单或SDK权限不足</p>
                    </div>
                    <div id="ordersCount" class="text-center py-4 text-gray-400 text-sm hidden">
                        共查询到 <span id="ordersTotalCount" class="font-bold text-blue-400">0</span> 条订单记录
                    </div>
                </div>

                <!-- 系统设置 -->
                <div id="settingsTab" class="tab-content hidden">
                    <h2 class="text-xl font-bold mb-6">系统配置</h2>
                    <div class="max-w-2xl space-y-6">
                        <!-- 同步持仓 -->
                        <div class="bg-gradient-to-r from-cyan-600 to-cyan-800 rounded-lg p-4 sm:p-6">
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 space-y-3 sm:space-y-0">
                                <div>
                                    <h3 class="text-lg sm:text-xl font-bold flex items-center">
                                        <i class="fas fa-wallet mr-2"></i>同步持仓
                                    </h3>
                                    <p class="text-sm text-cyan-200 mt-1">从长桥账号同步持仓到本地数据库</p>
                                </div>
                                <button id="syncPositionsBtn" class="px-4 sm:px-6 py-2 bg-white hover:bg-gray-100 text-cyan-600 rounded-lg transition-colors duration-200 text-sm font-medium">
                                    <i class="fas fa-sync mr-2"></i>立即同步
                                </button>
                            </div>
                            <div class="bg-cyan-900 bg-opacity-30 rounded-lg p-3">
                                <p class="text-xs text-cyan-200">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    <strong>功能说明：</strong>从长桥账号获取当前持仓，同步到本地系统。<br>
                                    <strong>适用场景：</strong>实盘模式，当长桥持仓发生变化时，点击此按钮手动同步。<br>
                                    <strong>自动同步：</strong>系统每120秒自动同步一次，无需手动操作。
                                </p>
                            </div>
                        </div>

                        <!-- 同步自选股 -->
                        <div class="bg-gradient-to-r from-purple-600 to-purple-800 rounded-lg p-4 sm:p-6">
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 space-y-3 sm:space-y-0">
                                <div>
                                    <h3 class="text-lg sm:text-xl font-bold flex items-center">
                                        <i class="fas fa-sync-alt mr-2"></i>同步自选股
                                    </h3>
                                    <p class="text-sm text-purple-200 mt-1">从长桥账号同步关注的股票（模拟模式下将添加MAG7）</p>
                                </div>
                                <button id="syncWatchlistBtn" class="px-4 sm:px-6 py-2 bg-white hover:bg-gray-100 text-purple-600 rounded-lg transition-colors duration-200 text-sm font-medium">
                                    <i class="fas fa-download mr-2"></i>立即同步
                                </button>
                            </div>
                        <div class="bg-purple-900 bg-opacity-30 rounded-lg p-3">
                            <p class="text-xs text-purple-200">
                                <i class="fas fa-info-circle mr-1"></i>
                                <strong>功能说明：</strong>从长桥账号自选股列表中导入美股股票到本地系统。
                            </p>
                        </div>
                        </div>

                        <div class="bg-gray-900 rounded-lg p-6">
                            <label class="block text-sm font-medium mb-2">止盈目标 (%)</label>
                            <input type="number" id="profitTargetInput" step="0.1" min="0.1" max="100" 
                                   class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
                            <p class="text-sm text-gray-400 mt-2">当股票涨幅达到此百分比时自动卖出（范围：0.1%-100%）</p>
                        </div>

                        <div class="bg-gray-900 rounded-lg p-6">
                            <label class="block text-sm font-medium mb-2">最大并发持仓数量</label>
                            <input type="number" id="maxConcurrentPositionsInput" step="1" min="1" max="10" 
                                   class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
                            <p class="text-sm text-gray-400 mt-2">同时最多持有几只股票（默认1，设置为2或更多可同时持有多只股票）</p>
                        </div>
                        
                        <div class="bg-gray-900 rounded-lg p-6">
                            <label class="block text-sm font-medium mb-2">长桥SDK配置</label>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">App Key</label>
                                    <input type="text" id="appKeyInput" placeholder="请输入长桥App Key" 
                                           class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">App Secret</label>
                                    <input type="password" id="appSecretInput" placeholder="请输入长桥App Secret" 
                                           class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Access Token</label>
                                    <input type="password" id="accessTokenInput" placeholder="请输入长桥Access Token" 
                                           class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200">
                                </div>
                            </div>
                            <div class="mt-4 p-3 bg-blue-900 bg-opacity-30 border border-blue-600 rounded-lg">
                                <p class="text-xs text-blue-200 mb-2">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    <strong>如何获取长桥API凭证：</strong>
                                </p>
                                <ol class="text-xs text-blue-200 space-y-1 ml-4 list-decimal">
                                    <li>访问 <a href="https://open.longbridgeapp.com" target="_blank" class="underline hover:text-blue-300">长桥开放平台</a></li>
                                    <li>注册并登录账户</li>
                                    <li>在控制台创建应用获取 App Key 和 App Secret</li>
                                    <li>生成 Access Token 用于API调用</li>
                                    <li>填写上述凭证并保存，系统将自动切换到真实交易模式</li>
                                </ol>
                                <p class="text-xs text-blue-200 mt-2">
                                    <i class="fas fa-shield-alt mr-1"></i>
                                    未配置时系统将使用模拟数据进行演示
                                </p>
                            </div>
                        </div>
                        
                        <button id="saveSettingsBtn" class="w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 font-medium">
                            <i class="fas fa-save mr-2"></i>保存设置
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加股票弹窗 -->
    <div id="addStockModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-end sm:items-center justify-center z-50 px-0 sm:px-4">
        <div class="mobile-modal bg-gray-800 rounded-xl sm:rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4 sticky top-0 bg-gray-800 pb-4 border-b border-gray-700">
                <h3 class="text-lg sm:text-xl font-bold">添加股票</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-white transition-colors duration-200 p-2">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">股票代码</label>
                    <input type="text" id="newStockSymbol" placeholder="例如: AAPL" autocapitalize="characters"
                           class="w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">公司名称</label>
                    <input type="text" id="newStockName" placeholder="例如: Apple Inc."
                           class="w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base">
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">类型</label>
                    <div class="flex space-x-4">
                        <label class="flex items-center cursor-pointer mobile-touch p-2">
                            <input type="radio" name="stockType" value="STOCK" checked class="mr-2 w-5 h-5">
                            <span class="flex items-center text-sm sm:text-base">
                                <i class="fas fa-chart-line text-blue-400 mr-1"></i>正股
                            </span>
                        </label>
                        <label class="flex items-center cursor-pointer mobile-touch p-2">
                            <input type="radio" name="stockType" value="OPTION" class="mr-2 w-5 h-5">
                            <span class="flex items-center text-sm sm:text-base">
                                <i class="fas fa-chart-area text-orange-400 mr-1"></i>期权
                            </span>
                        </label>
                    </div>
                </div>
                <div>
                    <label class="block text-xs sm:text-sm font-medium mb-2">分组</label>
                    <div class="flex items-center space-x-2">
                        <select id="newStockGroup" class="flex-1 px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base">
                            <option value="未分组">未分组</option>
                        </select>
                        <button id="addNewGroupBtn" class="px-4 py-3 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors duration-200 mobile-touch" title="新建分组">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                <div id="newGroupInput" class="hidden">
                    <label class="block text-xs sm:text-sm font-medium mb-2">新分组名称</label>
                    <div class="flex items-center space-x-2">
                        <input type="text" id="newGroupName" placeholder="输入分组名称"
                               class="flex-1 px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500 transition-colors duration-200 text-base">
                        <button id="saveGroupBtn" class="px-4 py-3 bg-green-600 hover:bg-green-700 rounded-lg transition-colors duration-200 mobile-touch">
                            <i class="fas fa-check"></i>
                        </button>
                        <button id="cancelGroupBtn" class="px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-colors duration-200 mobile-touch">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="flex flex-col space-y-2">
                    <button id="confirmAddStockBtn" class="flex-1 px-4 py-3.5 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 font-medium text-base mobile-touch">
                        <i class="fas fa-check mr-2"></i>确认
                    </button>
                    <button id="cancelAddStockBtn" class="flex-1 px-4 py-3.5 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors duration-200 font-medium text-base mobile-touch">
                        <i class="fas fa-times mr-2"></i>取消
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 详情弹窗 -->
    <div id="detailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-end sm:items-center justify-center z-50 px-0 sm:px-4">
        <div class="mobile-modal bg-gray-800 rounded-xl sm:rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4 sticky top-0 bg-gray-800 pb-4 border-b border-gray-700 z-10">
                <h3 class="text-base sm:text-lg sm:text-xl font-bold" id="detailModalTitle">详情</h3>
                <button id="closeDetailModalBtn" class="text-gray-400 hover:text-white transition-colors duration-200 p-2">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="detailModalContent" class="space-y-4 pb-4">
                <!-- 动态加载内容 -->
            </div>
        </div>
    </div>

    <!-- 页脚签名 -->
    <footer class="text-center py-6 mt-12">
        <p>由 <a href="https://with.woa.com/" style="color: #8A2BE2;" target="_blank">with</a> 通过自然语言生成</p>
    </footer>
    </div>

    <script src="app.js?v=20260117"></script>
    <script src="stock-kline.js?v=20260117"></script>
    <script src="auth.js?v=20260117"></script>
</body>
</html>
